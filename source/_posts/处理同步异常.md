---
title: 优雅处理 async/await 异常
tags:
  - async
  - await
categories:
  - Code
abbrlink: 31593
date: 2019-11-13 19:45:04
---

## 1 前言

`async/await` 是 ES7 中的新特性，方便开发者以同步逻辑书写异步的调用，避免回调地狱

但是对于这样的代码，怎样处理异常？

目前从网上查询的解决方法，大致有两种

## try catch

try catch 捕获是非常常见的捕获同步代码异常的方法，它可以轻松捕捉到`async/await` 的异常

```js
async function func() {
  // 通过try catch捕获异常调用的异常
  try {
    const data = await Api.get() // 同步写法、异步调用
    if (!data) {
      console.log('no data')
    }
  } catch (err) {
    console.log(err)
  }
}
```

假如一个 async 声明的函数中有多次的异步调用，那就需要在每一个在每个异步调用的代码块上，都包一层 try catch，注意，是每一个

当然也可以在最外层包一层 try catch，但是这样一旦有异常抛出，异常代码下方代码就不会再执行，也会造成代码逻辑上的错误

这明显就有悖于我们用 `async/await` 的初衷：使代码更加简洁

## go lang

从 Go 语言得到的灵感

GO 语言在执行一段代码后，会赋值两个变量，一个是正常运行结果，一个是运行时的异常

若异常为 null，则这一段代码运行就没有异常

```go
f, err := os.Open("filename.txt")

if err != nil { return err }
```

## 

得益于这种思路，可以使用一个


